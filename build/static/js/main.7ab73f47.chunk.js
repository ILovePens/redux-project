(this["webpackJsonpredux-app"]=this["webpackJsonpredux-app"]||[]).push([[0],{48:function(t,e,n){},55:function(t,e,n){},57:function(t,e,n){"use strict";n.r(e);var r=n(4),a=n.n(r),o=n(31),c=n.n(o),s=(n(48),n(59)),i=n(21),l=Object(i.a)(),u=n(1),d=n(2),p=n(23),b=n(5),h=n(6),f=function(t){try{var e=sessionStorage.getItem(t);if(null===e)return;return JSON.parse(e)}catch(n){return}},g=function(t,e){try{var n=JSON.stringify(t);sessionStorage.setItem(e,n)}catch(r){console.log(r)}},j=n(3),m=function(t){Object(b.a)(n,t);var e=Object(h.a)(n);function n(){var t;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(t=e.call.apply(e,[this].concat(a))).goToApp=function(e){e.preventDefault(),console.log(Object(p.a)(t));var n=t.pseudoInput.value;g({pseudo:n,stamp:(+new Date).toString(36)},"playerInfos"),l.push("/redux-project/")},t}return Object(d.a)(n,[{key:"render",value:function(){var t=this;return Object(j.jsxs)("div",{className:"connexionBox",children:[Object(j.jsx)("header",{className:"App-header",children:Object(j.jsx)("h1",{className:"logo",children:"Redux-progress"})}),Object(j.jsxs)("p",{children:["Hello there!",Object(j.jsx)("br",{}),"My name is Maxime Sarrazin, and this is Redux-progress, a work in progress of mini-games made with React and Redux, as a part of my learning journey in Javascript and complex application building."]}),Object(j.jsx)("p",{children:"To proceed to the games, please choose your player name below! (2\xa0to\xa010 characters)"}),Object(j.jsxs)("form",{className:"form connexion",onSubmit:function(e){return t.goToApp(e)},children:[Object(j.jsx)("input",{type:"text",placeholder:"name",required:!0,pattern:"[A-Z]*[a-z]*{2,10}",ref:function(e){t.pseudoInput=e}}),Object(j.jsx)("button",{type:"submit"})]})]})}}]),n}(a.a.Component),v=n(14),O=Object(v.c)({name:"nav",initialState:{},reducers:{reset:function(t){}}}),y=(O.actions.reset,O.reducer);function x(t){return Object(j.jsxs)("label",{className:"switch ".concat(t.styles),children:[Object(j.jsx)("input",{type:"checkbox",checked:t.isOn,onClick:t.onClick,readOnly:!0}),Object(j.jsx)("span",{className:"slider"})]})}function S(t){return Object(j.jsx)("button",{className:"reset",onClick:t.onClick,children:t.title})}function _(t){var e=t.itemSelected,n=Object.keys(t.items).map((function(n,r){return Object(j.jsx)("button",{name:n,className:e===n?"selected":"",onClick:e===n?function(){}:function(e){return t.handleClick(e)},children:"i"!==n?"Play ".concat(n):n},r)}));return Object(j.jsxs)("header",{className:"App-header",children:[Object(j.jsx)("h1",{className:"logo",children:"Redux-progress"}),Object(j.jsxs)("div",{className:"nav-items",children:[Object(j.jsx)("div",{className:"pseudo",children:t.pseudo}),n]})]})}var C=n(15),w=n(9),X=n.n(w),N=n(12),A=n(7),k=n(41),I=n(43),T=Object(k.a)({apiKey:"AIzaSyBcbjihs9sz2r212hEj8Dh1IjeDKfRqy7U",authDomain:"redux-progress.firebaseapp.com",databaseURL:"https://redux-progress-default-rtdb.europe-west1.firebasedatabase.app/",projectId:"redux-progress",storageBucket:"redux-progress.appspot.com",messagingSenderId:"1056425097273",appId:"1:1056425097273:web:26f5d8fe70bfe09b8cf5e8"});Object(I.a)(T);function F(t){var e=Object(A.b)();return new Promise((function(n){Object(A.a)(Object(A.d)(e,"/turnAction")).then((function(r){r.exists()?Object(A.a)(Object(A.d)(e,"/stepNumber")).then((function(a){a.exists()?r.val()!==t.turnAction||a.val()!==t.stepNumber?Object(A.a)(Object(A.d)(e,"/")).then((function(t){t.exists()?n(t.val()):console.log("No data available")})).catch((function(t){console.error(t)})):Object(A.a)(Object(A.d)(e,"/players")).then((function(t){t.exists()&&0===t.val()&&n(0)})).catch((function(t){console.error(t)})):console.log("No data available")})).catch((function(t){console.error(t)})):console.log("No data available")})).catch((function(t){console.error(t)}))}))}function P(t){var e=Object(A.b)();return new Promise((function(n){Object(A.a)(Object(A.d)(e,"/players")).then((function(r){r.exists()?t?n({players:r.val()}):Object(A.a)(Object(A.d)(e,"/gameSettings")).then((function(t){t.exists()?Object(A.a)(Object(A.d)(e,"/gameIsOn")).then((function(e){e.exists()?n({players:r.val(),gameSettings:t.val(),gameIsOn:e.val()}):console.log("No data available")})).catch((function(t){console.error(t)})):console.log("No data available")})).catch((function(t){console.error(t)})):console.log("No data available")})).catch((function(t){console.error(t)}))}))}var E={history:[{slots:Array(42).fill(0),boardFlip:0}],turnAction:{number:0,type:0},stepNumber:0,gameSettings:{width:7,height:6,scoreTarget:4},asyncStatus:"",currentSign:"X",players:null,sortIsAsc:!0,gravityState:!0,transitions:{slots:0,board:0,status:0},animations:0},B=Object(v.b)("connectX/compareGameState",function(){var t=Object(N.a)(X.a.mark((function t(e){var n;return X.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,F(e);case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),M=Object(v.b)("connectX/readGameState",function(){var t=Object(N.a)(X.a.mark((function t(e,n){var r,a,o;return X.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,P(e);case 2:if(r=t.sent,a=r.players,!e){t.next=12;break}if(!nt(n.getState())){t.next=9;break}return t.abrupt("return");case 9:a||(a=[]);case 10:t.next=15;break;case 12:1===(o=Object.keys(a).length)?(Object(A.e)(Object(A.d)(Object(A.b)(),"/gameSettings/"),Z(n.getState())),Object(A.e)(Object(A.d)(Object(A.b)(),"/gameIsOn/"),!1)):2===o&&(r.gameIsOn?n.dispatch(st(r.gameSettings)):n.dispatch(Y(!0))),o>2&&(n.dispatch(U()),n.dispatch(it(f())),a=[]);case 15:return t.abrupt("return",a);case 16:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),q=Object(v.c)({name:"connectX",initialState:E,reducers:{fillSlot:function(t,e){var n=e.payload,r=n.stepNumber,a=n.history,o=n.current,c=n.slots,s=n.slotIndex,i=t.currentSign;c[s]=i;var l=t.turnAction;!l.type&&r++,t.stepNumber=r;var u=l.number+1===2;if(!t.gravityState){var d=t.gameSettings.width,p=t.gameSettings.height;if(o.boardFlip%2===0?0===c[s+d]:0===c[s+p]){var b=t.animations?t.animations.slice():Array(d*p).fill(0);b[s]="floating",t.animations=b}t.transitions={slots:0,board:0},u?(t.turnAction={number:0,type:0},t.currentSign="X"===i?"O":"X"):(t.turnAction.number+=1,t.turnAction.type=1)}else t.turnAction.number+=1,t.turnAction.type=1;a=a.slice(0,r),t.history=a.concat([{slots:c,boardFlip:o.boardFlip}]);var h=t.players;h&&2===h.length&&(t.turnAction.action=!0)},gravity:function(t,e){var n,r=e.payload.slotIndex,a="undefined"!==typeof r,o=t.stepNumber,c=t.history.slice(0,o+1),s=c[o],i=s.slots.slice(),l=e.payload.toggle,u=t.gravityState,d=t.turnAction;if(console.log("isAction",l),l){console.log("gravityState",u),u=!u;var p=t.players;p&&2===p.length&&(t.turnAction.action=!0),n=d.number+1===2}else n=2===d.number,console.log("isEndTurn",n);var b=e.payload.noEdit;if(u||b){t.animations=0;var h=t.gameSettings.width,f=t.gameSettings.height;s.boardFlip%2!==0&&(h=t.gameSettings.height,f=t.gameSettings.width);var g=1;if(a){for(var j=0,m=f-1;m>0;m--)if(r>=(m-1)*h&&r<=m*h-1){j=f-m;break}g=j}for(var v=Array(h*f).fill(0),O=v.slice(),y=i.length-1-g*h;y>=0;y-=h){for(var x=0;x<h;x++){var S=y-x;if(i[S]&&(!a||r===S)){for(var _=g;_>0;_--){var C=S+h*_;if(!i[C]){b?O[S]="floating":(i[C]=i[S],i[S]=0,v[C]=_);break}}if(r===S)break}}if(a)break;g++}}var w=!d.type;if(b)t.animations=O;else{w&&o++,t.stepNumber=o,n?(t.turnAction={number:0,type:0,action:d.action},t.currentSign="X"===t.currentSign?"O":"X"):(t.turnAction.number=l?d.number+1:d.number,t.turnAction.type=l?2:d.type),c=c.slice(0,o),t.history=c.concat([{slots:i,boardFlip:s.boardFlip}]),t.gravityState=u;var X=!!(v&&v.filter((function(t){return 0!==t})).length>0);t.transitions={slots:u&&X?v:0,board:l||3!==d.type?0:t.transitions.board}}},flipBoardState:function(t,e){var n=t.stepNumber,r=t.history.slice(0,n+1),a=r[n],o=a.slots.slice(),c=e.payload,s=a.boardFlip+c;-1===s&&(s=3),4===s&&(s=0);var i=t.gameSettings.width,l=t.gameSettings.height;a.boardFlip%2!==0&&(i=t.gameSettings.height,l=t.gameSettings.width);for(var u=o.slice(),d=l,p=o.length-1;p>=0;p-=i){for(var b=0;b<i;b++){var h=p-b;u[1===c?l*(h+1-(d-1)*i)-d:l*(d*i-1-h)+d-1]=o[h]}d--}var f=t.turnAction;!f.type&&n++,t.stepNumber=n;var g=f.number+1===2,j=!t.gravityState;g&&j?(t.turnAction={number:0,type:0},t.currentSign="X"===t.currentSign?"O":"X"):(t.turnAction.number+=1,t.turnAction.type=3),r=r.slice(0,n),t.history=r.concat([{slots:u,boardFlip:s}]),t.transitions={slots:0,board:-90*c};var m=t.players;m&&2===m.length&&(t.turnAction.action=!0)},endTurn:function(t){t.turnAction={number:0,type:0,action:!0},t.currentSign="X"===t.currentSign?"O":"X",t.transitions={slots:0,board:0,status:1}},changeStep:function(t,e){t.stepNumber=e.payload,t.currentSign=t.stepNumber%2===0?"X":"O",t.turnAction={number:0,type:0},t.transitions={slots:0,board:0}},toggleSort:function(t){t.sortIsAsc=!t.sortIsAsc,t.transitions={slots:0,board:0}},setGameSettings:function(t,e){var n=e.payload;t.gameSettings=n,t.history=[{slots:Array(n.width*n.height).fill(0),boardFlip:0}]},setAsyncStatus:function(t,e){t.asyncStatus=e.payload},reset:function(t,e){var n=e.payload,r=t.history.slice(0,1);r[0].boardFlip=0;var a={slots:0,board:0};if(n){var o=Object(A.b)(),c=Object(A.d)(o,"/stepNumber/");Object(A.e)(c,0),c=Object(A.d)(o,"/gameSettings/"),Object(A.e)(c,t.gameSettings),c=Object(A.d)(o,"/history/"),Object(A.e)(c,r),c=Object(A.d)(o,"/turnAction/"),Object(A.e)(c,0),c=Object(A.d)(o,"/currentSign/"),Object(A.e)(c,"X"),c=Object(A.d)(o,"/transitions/"),Object(A.e)(c,a),c=Object(A.d)(o,"/gravityState/"),Object(A.e)(c,!0),c=Object(A.d)(o,"/gameIsOn/"),Object(A.e)(c,!0)}t.stepNumber=0,t.history=r,t.currentSign="X",t.turnAction={number:0,type:0},t.transitions=a,t.gravityState=!0},removePlayers:function(t){var e=Object(A.b)();Object(A.e)(Object(A.d)(e,"/players/"),0)}},extraReducers:function(t){t.addCase(B.pending,(function(t){console.log("updateStateAsync pending")})).addCase(B.fulfilled,(function(t,e){var n=e.payload;if(console.log("updateStateAsync",n),0===n)window.alert("Your opponent left! Reload the page to exit the current game"),t.players=null,t.asyncStatus="";else{t.history=n.history,t.stepNumber=n.stepNumber;var r=n.transitions;t.transitions={slots:r.slots,board:r.board},t.gravityState=n.gravityState;var a=n.turnAction;t.turnAction.number=2===a?0:a,t.asyncStatus=t.currentSign===n.currentSign?"watching":"",t.currentSign=n.currentSign}})).addCase(M.pending,(function(t){console.log("setGameStateAsync pending")})).addCase(M.fulfilled,(function(t,e){var n=e.payload;if(console.log("setGameStateAsync",n),n){var r=Object.keys(n),a=r.length;if(console.log("playersCount",a),a&&t.players||(console.log("setGameStateAsync []"),t.players=[]),a){var o=t.players,c=o.length;if(console.log("statePlayersCount",c),!c||2===a){var s=["O","X"];for(var i in 1===c&&(o=[]),r)o=o.concat({player:n[r[i]],sign:s[i]}),console.log("statePlayers",o),t.players=o;t.transitions={slots:0,board:0}}}}}))}}),G=q.actions,R=G.fillSlot,D=G.changeStep,H=G.toggleSort,z=G.gravity,J=G.flipBoardState,L=G.endTurn,W=G.setAsyncStatus,K=G.setGameSettings,Y=G.reset,U=G.removePlayers,Q=function(t){return t.connectX.history},Z=function(t){return t.connectX.gameSettings},V=function(t){return t.connectX.stepNumber},$=function(t){return t.connectX.sortIsAsc},tt=function(t){return t.connectX.gravityState},et=function(t){return t.connectX.currentSign},nt=function(t){return t.connectX.players},rt=function(t){return t.connectX.turnAction},at=function(t){return t.connectX.transitions},ot=function(t){return t.connectX.animations},ct=function(t){return function(e,n){e(J(t)),e(z({toggle:!1,noEdit:!tt(n())}))}},st=function(t){return function(e){e(Y()),e(K(t))}},it=function(t){return function(e,n){console.log(t),Object(A.e)(Object(A.c)(Object(A.d)(Object(A.b)(),"players")),{pseudo:t.pseudo,stamp:t.stamp}).then((function(){nt(n()).length||e(M(!1));var t=setInterval((function(){nt(n()).length<2?e(M(!1)):clearInterval(t)}),4e3)})).catch((function(t){}))}},lt=q.reducer,ut=n(8),dt=n.n(ut);var pt=function(t){var e=t.slotScore,n="",r=0;e&&(n="".concat(dt.a.hasTransition," ").concat(dt.a.fall),r=Math.round(10*(.16+.189*Math.log(e)))/10);var a=t.value?"".concat(dt.a.slotFilled," ").concat("X"===t.value?dt.a.slotFilledX:dt.a.slotFilledO):"",o=t.animation?t.animation:"";o=dt.a[o];var c=t.winStyle?dt.a.wonSlot:"";return Object(j.jsx)("button",{className:"".concat(dt.a.slot," ").concat(a," ").concat(c),onClick:t.onClick,children:Object(j.jsx)("div",{style:{"--slotStartPos":"calc(".concat(-1*e*133.3,"%)"),"--speed":"".concat(r,"s")},className:"".concat(n," ").concat(o||""),onTransitionEnd:t.handleTransitionEnd})})};function bt(){var t=dt.a.wonSlot;Array.from(document.querySelectorAll(".".concat(t))).forEach((function(e){e.classList.remove(t),e.classList.add(dt.a.win)}))}var ht=function(t){Object(b.a)(n,t);var e=Object(h.a)(n);function n(){var t;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(t=e.call.apply(e,[this].concat(a))).handleTransitionEnd=function(t){console.log("hey style win transitionend"),bt()},t.renderSlot=function(e,n,r,a){var o,c=n?void 0:function(){return t.props.onClick(e)},s=n?t.props.winIndexes:null,i=!(!s||!s.includes(e)),l=0;if(r&&(l=r,i)){var u=t.props.transitions.slots,d=u.filter((function(t){return 0!==t})).sort((function(t,e){return e-t}))[0];e===u.findIndex((function(t){return t===d}))&&(o=function(e){return t.handleTransitionEnd(e)})}return Object(j.jsx)(pt,{value:t.props.slots[e],onClick:c,slotScore:l,winStyle:i,animation:a,handleTransitionEnd:o},e)},t.createBoard=function(e,n,r){for(var a=[],o=0,c=t.props.transitions,s=c?t.props.transitions.slots:null,i=t.props.animations?t.props.animations:null,l=0,u=0,d=0;d<e.height;d++){for(var p=[],b=0;b<e.width;b++)s&&(l=s[o]),i&&(u=i[o]),p.push(t.renderSlot(o,r,l,u)),o++;a.push(Object(j.jsx)("div",{className:dt.a.board_row,children:p},d))}var h=c?t.props.transitions.board:0;return Object(j.jsx)("div",{style:{"--boardStartPos":"rotateZ(".concat(h,"deg)")},className:"\n              ".concat(dt.a.board," \n              ").concat(n?dt.a.main_board:""," \n              ").concat(n?t.props.flip:""," \n              ").concat(0===h?"":"".concat(dt.a.flip," ").concat(dt.a.hasTransition)," \n              ").concat(t.props.isSelected?dt.a.selected:"","\n            "),onTransitionEnd:n&&r?function(){return t.handleTransitionEnd()}:void 0,children:a})},t.styleBoard=function(t,e){var n=e.height,r=e.width,a=Math.floor(.55*window.innerHeight/(n*t)),o=Math.floor(.55*window.innerHeight/(r*t)),c=Math.floor(.85*window.innerWidth/(n*t)),s=Math.floor(.85*window.innerWidth/(r*t));return{"--boardWidth":(a=(a=a<=o?a:o)<=(c=c<=s?c:s)?a:c)*r+"px","--boardHeight":a*n+"px","--slotSize":a+"px","--slotContentSize":Math.floor(.75*a-1)+"px"}},t}return Object(d.a)(n,[{key:"componentDidUpdate",value:function(){var t=this.props.transitions;this.props.isMainBoard&&(!function(){var t=dt.a.hasTransition,e=Array.from(document.querySelectorAll(".".concat(t)));console.log(e),e.forEach((function(e){e.classList.remove(t),setTimeout((function(){e.classList.add(dt.a.transition)}),0)}))}(),t&&(t.slots||t.board||t.status)||!this.props.winIndexes.length||bt(),document.documentElement.style.setProperty("--vh","".concat(.01*window.innerHeight,"px")))}},{key:"render",value:function(){var t=this.props.boardParams;this.props.flip%2!==0&&(t={width:t.height,height:t.width});var e=this.props.isMainBoard,n=4,r=dt.a.moves_board,a="",o=!1,c=null;if(e){n=1,r=dt.a.main,this.props.statusClass.disabled&&(a=dt.a.disabledBoard);var s=this.props.statusClass;c=Object(j.jsxs)("div",{className:dt.a.statusHandler,children:[Object(j.jsx)("button",{className:"".concat(s.current)}),Object(j.jsx)("button",{onClick:this.props.endTurnFunc,className:"".concat(s.previous)})]}),this.props.winIndexes.length&&(o=!0)}return Object(j.jsxs)("div",{style:this.styleBoard(n,t),className:"".concat(r," ").concat(a),children:[c,this.createBoard(t,e,o)]})}}]),n}(a.a.Component),ft=function(t){Object(b.a)(n,t);var e=Object(h.a)(n);function n(){var t;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(t=e.call.apply(e,[this].concat(a))).prepareInfos=function(e){e.preventDefault();var n=parseInt(t.width.value),r=parseInt(t.height.value),a=n<=r?n:r,o=Math.round(.8+1.7*Math.log((n+r)/2)),c={width:n,height:r,scoreTarget:a<=o?a:o};t.props.sendGameSettings(c),t.infosForm.reset()},t}return Object(d.a)(n,[{key:"render",value:function(){var t=this;return Object(j.jsxs)("form",{className:"form",onSubmit:function(e){return t.prepareInfos(e)},ref:function(e){return t.infosForm=e},children:[Object(j.jsx)("span",{children:"Largeur :"}),Object(j.jsx)("input",{type:"text",pattern:"\\b([3-9]|[12][0-9]|3[0-2])\\b",maxLength:this.props.length,ref:function(e){return t.width=e},placeholder:" 3-32",required:!0}),Object(j.jsx)("span",{children:"Hauteur :"}),Object(j.jsx)("input",{type:"text",pattern:"\\b([3-9]|[12][0-9]|3[0-2])\\b",maxLength:this.props.length,ref:function(e){return t.height=e},placeholder:" 3-32",required:!0}),Object(j.jsx)("button",{type:"submit"})]})}}]),n}(a.a.Component);function gt(t){var e,n=Object(C.b)(),r=Object(C.c)(Q),a=Object(C.c)(V),o=Object(C.c)(Z),c=Object(C.c)(rt),s=Object(C.c)(nt),i=Object(C.c)(et),l=Object(C.c)(tt),u=Object(C.c)(at),d=Object(C.c)(ot),p=Object(C.c)($),b=r[a].slots,h=t.playerInfos,f=h.pseudo,g=Object(j.jsx)(ft,{sendGameSettings:function(t){return n(st(t))}}),m=Object(j.jsx)("button",{onClick:function(){return n(it(h))},children:"Request game"}),v=null,O=Object(j.jsx)(S,{title:"Reset",onClick:function(){return n(Y())}}),y=Object(j.jsxs)("span",{children:[Object(j.jsx)("button",{onClick:function(){return n(ct(1))},children:"Flip right"}),Object(j.jsx)("button",{onClick:function(){return n(ct(-1))},children:"Flip left"}),Object(j.jsx)(x,{isOn:!l,onClick:function(){return n(z({toggle:!0}))}})]}),_=Object(j.jsxs)("span",{children:[Object(j.jsx)("button",{className:dt.a.disabled,onClick:function(){},children:"Flip right"}),Object(j.jsx)("button",{className:dt.a.disabled,onClick:function(){},children:"Flip left"}),Object(j.jsx)(x,{className:dt.a.disabled,isOn:!l,onClick:function(){}})]}),w=function(t){return n((e=t,function(t,n){var r=V(n()),a=Q(n()).slice(0,r+1),o=a[r],c=o.slots.slice(),s=tt(n());c[e]||(t(R({stepNumber:r,history:a,current:o,slots:c,slotIndex:e,gravityState:s})),s&&t(z({toggle:!1,slotIndex:e})))}));var e},X=1===r.length?"startOfGame":"startOfTurn",N="";console.log("players",s);var k,I,T=h.stamp;if(s&&s.length>0){var F=s.length;console.log("playerCount",F);var P=s.find((function(t){return t.player.pseudo===f&&t.player.stamp===T})),E=void 0!==P;if(console.log("myplayer",P),E){var q=1===F,G=2===F;if((q||G)&&(console.log("waitingForGame",q),window.onunload=function(t){n(U())}),G){var J=P.sign,K=J===i;console.log(K),N="You are the ".concat("X"===J?"red":"blue"," player. ").concat(K?"Your turn to play!":"It's your opponent's turn."),c.action&&function(t){console.log("updateDb");var e=Object(A.b)(),n=t.stepNumber,r=Object(A.d)(e,"/history/".concat(n));Object(A.e)(r,t.history[n]),r=Object(A.d)(e,"/stepNumber/"),Object(A.e)(r,n),r=Object(A.d)(e,"/turnAction/"),Object(A.e)(r,t.turnAction.number),r=Object(A.d)(e,"/currentSign/"),Object(A.e)(r,t.currentSign),r=Object(A.d)(e,"/gravity/"),Object(A.e)(r,t.gravityState),r=Object(A.d)(e,"/transitions/"),Object(A.e)(r,t.transitions),r=Object(A.d)(e,"/animations/"),Object(A.e)(r,t.animations)}({history:r,stepNumber:a,turnAction:c,currentSign:i,gravityState:l,transitions:u,animations:d}),K||(n(function(t){return function(e,n){if("watching"!==n().connectX.asyncStatus)var r=setInterval((function(){var a={turnAction:rt(n()).number,stepNumber:V(n())};t===et(n())||2!==nt(n()).length?clearInterval(r):e(B(a))}),4e3);e(W("watching"))}}(J)),w=function(){},y=_),g=null,O=null}m=null}else{2===F&&(m=null),1===F&&(m=Object(j.jsx)("button",{className:dt.a.highlighted,onClick:function(){return n(it(h))},children:"Join game"}))}}else s||(console.log("am i crazy",s),n((function(t){t(M(!0))})));if(console.log("currentSign",i),"X"===i?(k=dt.a.redPlayerTurn,I=dt.a.bluePlayerTurn):(k=dt.a.bluePlayerTurn,I=dt.a.redPlayerTurn),c.number){var lt=c.type;console.log("previousAction",lt),1===lt?(w=function(){},v=Object(j.jsx)("button",{onClick:function(){return n(L())},children:"End turn"}),e=function(){return n(L())},k={current:"".concat(k),previous:"".concat(dt.a.canEndTurn," ").concat(dt.a.fadeInOnHover," ").concat(dt.a.hasTransition),disabled:!0},X="canEndTurn"):(k={current:"".concat(k),previous:""},y=_,X="hasToPlay")}else console.log(u),k={current:k,previous:r.length>1?"".concat(u.status?"".concat(dt.a.endTurn," ").concat(I):I," ").concat(dt.a.fadeout," ").concat(dt.a.hasTransition):""};var ut,pt=r[a].boardFlip,bt={width:o.width,height:o.height},gt=r.map((function(t,e){var o=e?"Move #"+e:"Game start",c=a===e,s=e===r.length-1;return Object(j.jsxs)("li",{children:[Object(j.jsx)("p",{children:Object(j.jsx)("span",{children:o})}),Object(j.jsx)(ht,{boardParams:bt,isSelected:c,slots:r[e].slots,transitions:s?u:null,flip:r[e].boardFlip,onClick:function(){return n(function(t){return function(e,n){nt(n()).length<2&&e(D(t))}}(e))},title:o})]},e)}));gt=p?gt:gt.sort((function(t,e){return e.key-t.key}));var jt=[],mt=o.scoreTarget;if(a>=2*mt-1){var vt=pt%2===0?bt.width:bt.height;jt=function(t,e,n,r){var a=[],o=[],c=[];for(var s in e)e[s]!==t[s]&&c.push(parseInt(s));for(var i=c.length-1;i>=0;i--){var l=c[i];if(!o.includes(l)){for(var u=e[l],d=0,p=l;p>l-n&&e[p-1]&&e[p-1]===u&&p%r!==0;p--)d++,a.push(p-1);for(var b=0,h=l;h<l+n&&e[h+1]&&e[h+1]===u&&(h+1)%r!==0;h++)b++,a.push(h+1);d+b>=n-1&&(a.push(l),o=o.concat(a)),a=[];for(var f=0,g=l;g>l-n*r&&e[g-r]&&e[g-r]===u;g-=r)f++,a.push(g-r);for(var j=0,m=l;m<l+n*r&&e[m+r]&&e[m+r]===u;m+=r)j++,a.push(m+r);f+j>=n-1&&(a.push(l),o=o.concat(a)),a=[];for(var v=0,O=l;O>l-n*(r+1)&&e[O-r-1]&&e[O-r-1]===u&&O%r!==0;O-=r+1)v++,a.push(O-r-1);for(var y=0,x=l;x<l+n*(r+1)&&e[x+r+1]&&e[x+r+1]===u&&(x+1)%r!==0;x+=r+1)y++,a.push(x+r+1);v+y>=n-1&&(a.push(l),o=o.concat(a)),a=[];for(var S=0,_=l;_>l-n*(r-1)&&e[_-r+1]&&e[_-r+1]===u&&(_+1)%r!==0;_-=r-1)S++,a.push(_-r+1);for(var C=0,w=l;w<l+n*(r-1)&&e[w+r-1]&&e[w+r-1]===u&&w%r!==0;w+=r-1)C++,a.push(w+r-1);S+C>=n-1&&(a.push(l),o=o.concat(a)),a=[]}}return o}(r[a-1].slots,b,mt,vt)}if(jt.length){y=_,e=function(){},w=function(){},X="endOfGame";var Ot=0;jt.forEach((function(t){"X"===b[t]&&Ot++})),ut=Ot>jt.length-Ot?"Winner: X":Ot<jt.length-Ot?"Winner: O":"Draw!"}else jt.length||a!==b.length?ut="".concat("X"===i?"Red":"Blue"," player's turn"):(ut="Draw!",X="endOfGame");return Object(j.jsxs)("div",{className:dt.a.game,children:[Object(j.jsxs)("div",{className:dt.a.gameInfos,children:[Object(j.jsxs)("span",{className:dt.a.status,children:[ut," - ",X]}),g,N]}),Object(j.jsx)(ht,{isMainBoard:!0,statusClass:k,boardParams:bt,slots:b,flip:pt,winIndexes:jt,onClick:function(t){return w(t)},endTurnFunc:e,transitions:u,animations:d}),Object(j.jsxs)("div",{className:dt.a.controls,children:[m,y,v,O]}),Object(j.jsxs)("div",{className:dt.a.scrollableX,children:[Object(j.jsx)(x,{isOn:!p,styles:dt.a.toggleSort,onClick:function(){return n(H())}}),Object(j.jsx)("ol",{className:dt.a.moves,children:gt})]})]})}var jt=function(){var t=Object(j.jsxs)("div",{className:"infos",children:[Object(j.jsx)("h3",{children:"Connect-X"}),Object(j.jsx)("h4",{children:"General rules"}),Object(j.jsxs)("p",{children:["It is a Connect 4 like game, in which you can choose the board dimensions, as well as use special actions!",Object(j.jsx)("br",{}),"Each turn, in addition of playing a token, the players can choose to use one of three different actions during their turn:"]}),Object(j.jsxs)("ul",{children:[Object(j.jsx)("li",{children:"turn the gravity OFF or ON again"}),Object(j.jsx)("li",{children:"flip the board to the left"}),Object(j.jsx)("li",{children:"flip the board to the right"})]}),Object(j.jsx)("h4",{children:"Versus mode"}),Object(j.jsxs)("p",{children:["You can also play online versus an opponent! Just click on the multiplayer button and wait for your opponent to do the same, you'll be notified when the game starts!",Object(j.jsx)("br",{}),"Note that the board dimensions that the versus will take place on are the one currently used by the first player to request the versus."]})]});return Object(j.jsxs)("div",{className:"infosPage",children:[Object(j.jsx)("h2",{children:"Welcome to the games!"}),t,Object(j.jsx)("h3",{children:"Other games to come soon..."})]})},mt=(n(55),function(t){Object(b.a)(n,t);var e=Object(h.a)(n);function n(){var t;return Object(u.a)(this,n),(t=e.call(this)).state={items:{"Connect-X":gt,i:jt},itemSelected:"i",playerInfos:null},t.handleClick=t.handleClick.bind(Object(p.a)(t)),t}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var t=this.state.playerInfos;console.log("componentDidMount",t),t||(t=f("playerInfos"),console.log("pseudo after loadState",t),t||(t=null),this.setState({playerInfos:t}),t||l.push("/redux-project/login")),document.documentElement.style.setProperty("--vh","".concat(.01*window.innerHeight,"px"))}},{key:"componentDidUpdate",value:function(){document.documentElement.style.setProperty("--vh","".concat(.01*window.innerHeight,"px"))}},{key:"handleClick",value:function(t){this.setState({itemSelected:t.target.name})}},{key:"render",value:function(){var t=this.state.playerInfos;console.log("render",t);var e=this.state.itemSelected?a.a.createElement(this.state.items[this.state.itemSelected],{playerInfos:t}):null;return Object(j.jsxs)("div",{className:"App",children:[Object(j.jsx)(_,{items:this.state.items,itemSelected:this.state.itemSelected,handleClick:this.handleClick,pseudo:t?t.pseudo:""}),Object(j.jsx)("div",{className:"main",children:e})]})}}]),n}(r.Component)),vt=function(){return Object(j.jsx)("h2",{className:"notFound",children:"Nothing to see here"})},Ot=n(17),yt=n(19);function xt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return new Promise((function(e){return setTimeout((function(){return e({data:t})}),500)}))}var St=Object(v.b)("counter/fetchCount",function(){var t=Object(N.a)(X.a.mark((function t(e){var n;return X.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,xt(e);case 2:return n=t.sent,t.abrupt("return",n.data);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),_t=Object(v.c)({name:"counter",initialState:{value:0,status:"idle"},reducers:{increment:function(t){t.value+=1},decrement:function(t){t.value-=1},incrementByAmount:function(t,e){t.value+=e.payload},reset:function(t){t.value=0}},extraReducers:function(t){t.addCase(St.pending,(function(t){t.status="loading"})).addCase(St.fulfilled,(function(t,e){t.status="idle",t.value+=e.payload}))}}),Ct=_t.actions,wt=(Ct.increment,Ct.decrement,Ct.incrementByAmount,Ct.reset,_t.reducer),Xt={history:[{squares:Array(9).fill(null)}],winSquares:[],xIsNext:!0,stepNumber:0,sortIsAsc:!0},Nt=Object(v.c)({name:"tictactoe",initialState:Xt,reducers:{handleClick:function(t,e){var n=t.history.slice(0,t.stepNumber+1),r=n[n.length-1].squares.slice();t.winSquares.length||r[e.payload]||(r[e.payload]=t.xIsNext?"X":"O",t.history=n.concat([{squares:r}]),t.stepNumber=n.length,t.xIsNext=!t.xIsNext)},jumpTo:function(t,e){t.stepNumber=e.payload,t.xIsNext=e.payload%2===0},toggleSort:function(t){t.sortIsAsc=!t.sortIsAsc},reset:function(t){t.history=[{squares:Array(9).fill(null)}],t.stepNumber=0}}}),At=Nt.actions,kt=(At.handleClick,At.jumpTo,At.toggleSort,At.reset,Nt.reducer),It=Object(yt.b)({nav:y,counter:wt,tictactoe:kt,connectX:lt}),Tt=Object(v.d)({serializableCheck:!1}),Ft=Object(v.a)({reducer:function(t,e){return"nav/reset"===e.type&&(t=void 0),It(t,e)},middleware:Object(Ot.a)(Tt)}),Pt="/redux-project";c.a.render(Object(j.jsx)(a.a.StrictMode,{children:Object(j.jsx)(C.a,{store:Ft,children:Object(j.jsx)(s.b,{history:l,children:Object(j.jsxs)(s.c,{children:[Object(j.jsx)(s.a,{exact:!0,path:"".concat(Pt,"/login"),component:m}),Object(j.jsx)(s.a,{path:"".concat(Pt),component:mt}),Object(j.jsx)(s.a,{path:"".concat(Pt,"/"),component:vt})]})})})}),document.getElementById("root"))},8:function(t,e,n){t.exports={game:"ConnectX_game__1x_fZ",main:"ConnectX_main__6vhcL",statusHandler:"ConnectX_statusHandler__3YJ_C",previousStatus:"ConnectX_previousStatus__2I2T6",canEndTurn:"ConnectX_canEndTurn__AbWWA",endTurn:"ConnectX_endTurn__13PRx",redPlayerTurn:"ConnectX_redPlayerTurn__2yS_K",bluePlayerTurn:"ConnectX_bluePlayerTurn__3Aih7",board:"ConnectX_board__3OnTo",main_board:"ConnectX_main_board__1BL24",board_row:"ConnectX_board_row__CsIJA",slot:"ConnectX_slot__25hJA",disabledBoard:"ConnectX_disabledBoard__2gQ8q",slotFilled:"ConnectX_slotFilled__3GXCE",slotFilledX:"ConnectX_slotFilledX___bTyR",slotFilledO:"ConnectX_slotFilledO__MNApa",gameInfos:"ConnectX_gameInfos__3A7p2",controls:"ConnectX_controls__ekhdW",status:"ConnectX_status__2MWFR",moves:"ConnectX_moves__1ki_t",moves_board:"ConnectX_moves_board__22KjK",highlighted:"ConnectX_highlighted__B2e4K",selected:"ConnectX_selected__1Puyt","kbd-navigation":"ConnectX_kbd-navigation__35g11",scrollableX:"ConnectX_scrollableX__3qCQG",toggleSort:"ConnectX_toggleSort__1_Kx-",hidden:"ConnectX_hidden__q8zIi",win:"ConnectX_win__X-N9o",scaleAnim:"ConnectX_scaleAnim__3zEhe",floating:"ConnectX_floating__D0otu","Slot-floating":"ConnectX_Slot-floating__2-Yy4",transition:"ConnectX_transition__38xtB",fadeInOnHover:"ConnectX_fadeInOnHover__2GqTp",hasTransition:"ConnectX_hasTransition__1g-sA",flip:"ConnectX_flip__2PQK3",fadeout:"ConnectX_fadeout__2xFop",fall:"ConnectX_fall__13rRa"}}},[[57,1,2]]]);
//# sourceMappingURL=main.7ab73f47.chunk.js.map